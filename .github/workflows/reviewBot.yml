name: review PR by Zenkins v0.1

on: 
  issue_comment:
    types: [created]
jobs:
  review:
    runs-on: ubuntu-latest

    steps:
      - name: guard for magic spell
        if: ${{ github.event.comment.body != '@zenkins review' }}
        run: exit 1

      - name: Review bump components PR
        run: |
          # auth with zenkins to prevent self approval not allowed issue
          echo ${{ secrets.ZENKINS_TOKEN }} > .githubtoken
          gh auth login --with-token < .githubtoken
          gh pr review ${{ github.event.issue.number }} --approve -R wireapp/wire-ios-mocktransport
          rm .githubtoken
